<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>RTAI API: Shared memory services.</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.4 -->
<div class="qindex">  <form class="search" action="search.php" method="get">
<a class="qindex" href="main.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class="qindex" href="annotated.html">Data&nbsp;Structures</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Data&nbsp;Fields</a> | <a class="qindex" href="globals.html">Globals</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a>  | <span class="search"><u>S</u>earch&nbsp;for&nbsp;<input class="search" type="text" name="query" value="" size="20" accesskey="s"/></span></form></div>
<h1>Shared memory services.</h1><hr><a name="_details"></a><h2>Detailed Description</h2>
This module contains some functions that allow sharing memory inter-intra real-time tasks and Linux processes. 
<p>
In fact it can be an alternative to SYSTEM V shared memory, the services are symmetrical, i.e. similar calls can be used both in real time tasks, i.e. within the kernel, and Linux processes. The function calls for Linux processes are inlined in this file. This approach has been preferred to a library since: is simpler, more effective, the calls are short, simple and just a few per process. 
<p>
<table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Files</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>file &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="rtai__nam2num_8h.html">rtai_nam2num.h</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Conversion between characters strings and unsigned long identifiers. <br><br></td></tr>

<p>
<tr><td class="memItemLeft" nowrap align=right valign=top>file &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="rtai__shm_8h.html">rtai_shm.h</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Interface of the <a class="el" href="group__shm.html">RTAI SHM module</a>. <br><br></td></tr>

<p>
<tr><td class="memItemLeft" nowrap align=right valign=top>file &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="shm_8c.html">shm.c</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Implementation of the <a class="el" href="group__shm.html">RTAI SHM module</a>. <br><br></td></tr>

<p>
<tr><td colspan=2><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="group__shm.html#a27">rt_named_malloc</a>(name, size, suprt)&nbsp;&nbsp;&nbsp;_rt_named_malloc(0, name, size, suprt)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Allocate a chunk of memory to be shared inter-intra kernel modules and Linux processes. </em> <a href="#a27"></a><em><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="group__shm.html#a29">rt_named_malloc_adr</a>(start_address, name, size, suprt)&nbsp;&nbsp;&nbsp;_rt_named_malloc(start_address, name, size, suprt)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Allocate a chunk of memory to be shared inter-intra kernel modules and Linux processes. </em> <a href="#a29"></a><em><br><br></td></tr>
<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>int&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="group__shm.html#a6">rt_named_free</a> (unsigned long name, void *adr)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Free a chunk of shared memory being shared inter-intra kernel modules and Linux processes. </em> <a href="#a6"></a><em><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>void *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="group__shm.html#a10">rt_named_malloc</a> (unsigned long name, int size, int suprt)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Allocate a chunk of memory to be shared inter-intra kernel modules and Linux processes. </em> <a href="#a10"></a><em><br><br></td></tr>
</table>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="a27" doxytag="rtai_shm.h::rt_named_malloc" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define rt_named_malloc</td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">name,         <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>size,         <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>suprt&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;_rt_named_malloc(0, name, size, suprt)
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Allocate a chunk of memory to be shared inter-intra kernel modules and Linux processes. 
<p>
rt_named_malloc/rtai_malloc are used to allocate in user space.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>name</em>&nbsp;</td><td>is an unsigned long identifier;</td></tr>
    <tr><td valign=top><em>size</em>&nbsp;</td><td>is the amount of required shared memory.</td></tr>
    <tr><td valign=top><em>suprt</em>&nbsp;</td><td>is the alloc/free support to use: USE_RT_MALLOC/USE_RTAI_SHM</td></tr>
  </table>
</dl>
Since <code>name</code> can be a clumsy identifier, services are provided to convert 6 characters identifiers to unsigned long, and vice versa.<p>
<dl compact><dt><b>See also:</b></dt><dd>the functions <a class="el" href="rtai__nam2num_8h.html#a0">nam2num()</a> and <a class="el" href="rtai__nam2num_8h.html#a1">num2nam()</a>.</dd></dl>
It must be remarked that the first allocation does a real allocation, any subsequent call to allocate with the same name from Linux processes just maps * the area to the user space, or return the related pointer to the already allocated space in kernel space. The functions return a pointer to the allocated memory, appropriately mapped to the memory space in use.<p>
<dl compact><dt><b>Returns:</b></dt><dd>a valid address on succes, 0 on failure.</dd></dl>
<dl compact><dt><b>Note:</b></dt><dd>If the same process calls <a class="el" href="group__shm.html#a30">rtai_malloc_adr()</a> and rtai_malloc twice in the same process it get a zero return value on the second call. </dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="a29" doxytag="rtai_shm.h::rt_named_malloc_adr" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define rt_named_malloc_adr</td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">start_address,         <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>name,         <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>size,         <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>suprt&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;_rt_named_malloc(start_address, name, size, suprt)
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Allocate a chunk of memory to be shared inter-intra kernel modules and Linux processes. 
<p>
rt_named_malloc_adr/rtai_malloc_adr are used to allocate in user space.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>start_address</em>&nbsp;</td><td>is a user desired address where the allocated memory should be mapped in user space;</td></tr>
    <tr><td valign=top><em>name</em>&nbsp;</td><td>is an unsigned long identifier;</td></tr>
    <tr><td valign=top><em>size</em>&nbsp;</td><td>is the amount of required shared memory.</td></tr>
    <tr><td valign=top><em>suprt</em>&nbsp;</td><td>is the alloc/free support to use: USE_RT_MALLOC/USE_RTAI_SHM</td></tr>
  </table>
</dl>
Since <code>name</code> can be a clumsy identifier, services are provided to convert 6 characters identifiers to unsigned long, and vice versa.<p>
<dl compact><dt><b>See also:</b></dt><dd>the functions <a class="el" href="rtai__nam2num_8h.html#a0">nam2num()</a> and <a class="el" href="rtai__nam2num_8h.html#a1">num2nam()</a>.</dd></dl>
It must be remarked that the first allocation does a real allocation, any subsequent call to allocate with the same name from Linux processes just maps * the area to the user space, or return the related pointer to the already allocated space in kernel space. The functions return a pointer to the allocated memory, appropriately mapped to the memory space in use.<p>
<dl compact><dt><b>Note:</b></dt><dd>If the same process calls rtai_malloc_adr and <a class="el" href="group__shm.html#a28">rtai_malloc()</a> twice in the same process it get a zero return value on the second call.</dd></dl>
<dl compact><dt><b>Returns:</b></dt><dd>a valid address on succes, 0 on failure. </dd></dl>
    </td>
  </tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a6" doxytag="rtai_shm.h::rt_named_free" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int rt_named_free </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">unsigned long&nbsp;</td>
          <td class="mdname" nowrap> <em>name</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>void *&nbsp;</td>
          <td class="mdname" nowrap> <em>adr</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [inline, static]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Free a chunk of shared memory being shared inter-intra kernel modules and Linux processes. 
<p>
rt_named_free/rtai_free are used to free from the user space a previously allocated shared memory.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>name</em>&nbsp;</td><td>is the unsigned long identifier used when the memory was allocated;</td></tr>
    <tr><td valign=top><em>adr</em>&nbsp;</td><td>is the related address.</td></tr>
  </table>
</dl>
Analogously to what done by the allocation functions the freeing calls have just the effect of unmapping any user space shared memory being freed till the last is done, as that is the one the really frees any allocated memory.<p>
<dl compact><dt><b>Returns:</b></dt><dd>the size of the succesfully freed memory, 0 on failure. </dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="a10" doxytag="shm.c::rt_named_malloc" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void* rt_named_malloc </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">unsigned long&nbsp;</td>
          <td class="mdname" nowrap> <em>name</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>size</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>suprt</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Allocate a chunk of memory to be shared inter-intra kernel modules and Linux processes. 
<p>
<p><b>For internal use only.</b></p>
<p>
rt_named_malloc is used to allocate shared memory.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>name</em>&nbsp;</td><td>is an unsigned long identifier;</td></tr>
    <tr><td valign=top><em>size</em>&nbsp;</td><td>is the amount of required shared memory;</td></tr>
    <tr><td valign=top><em>suprt</em>&nbsp;</td><td>is the alloc/free support to use: USE_RT_MALLOC/USE_RTAI_SHM</td></tr>
  </table>
</dl>
Since <em>name</em> can be a clumsy identifier, services are provided to convert 6 characters identifiers to unsigned long, and vice versa.<p>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="rtai__nam2num_8h.html#a0">nam2num()</a> and <a class="el" href="rtai__nam2num_8h.html#a1">num2nam()</a>.</dd></dl>
It must be remarked that the first allocation does a real allocation, any subsequent call to allocate with the same name from Linux processes just maps the area to the user space, or return the related pointer to the already allocated space in kernel space. The functions return a pointer to the allocated memory, appropriately mapped to the memory space in use.<p>
<dl compact><dt><b>Returns:</b></dt><dd>a valid address on succes, 0 on failure. </dd></dl>
</p>
    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Sun Jan 11 16:25:31 2004 for RTAI API by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 > 
</a>1.3.4 </small></address>
</body>
</html>
